# é˜¿é‡Œäº‘æœåŠ¡å™¨ ali_lanyu å®Œæ•´å¤‡ä»½

## ğŸ“¦ å¤‡ä»½æ¦‚è§ˆ
- **å¤‡ä»½æ—¶é—´**: 2025å¹´8æœˆ7æ—¥ 14:52
- **æœåŠ¡å™¨**: ali_lanyu (47.116.172.28)
- **ç³»ç»Ÿ**: CentOS 7 (Core)
- **å¤‡ä»½å¤§å°**: 22MB (å‹ç¼©å)

## ğŸ“ å¤‡ä»½æ–‡ä»¶ç»“æ„

```
ali_lanyu_server_backup_final/
â”œâ”€â”€ backup_ali_lanyu_complete_20250807.tar.gz (22MB) - å®Œæ•´å¤‡ä»½å‹ç¼©åŒ…
â”œâ”€â”€ backup_data/                                      - å¤‡ä»½æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ mysql/           - æ•°æ®åº“å¤‡ä»½
â”‚   â”‚   â”œâ”€â”€ all_databases.sql (1.2MB) - å®Œæ•´æ•°æ®åº“å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ database_list.txt          - æ•°æ®åº“åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ mysql_users.txt            - ç”¨æˆ·æƒé™
â”‚   â”œâ”€â”€ nginx/           - Nginxé…ç½®
â”‚   â”‚   â””â”€â”€ nginx_configs.tar.gz (9.7KB) - é…ç½®å’ŒSSLè¯ä¹¦
â”‚   â”œâ”€â”€ system/          - ç³»ç»Ÿé…ç½®
â”‚   â”‚   â””â”€â”€ system_configs.tar.gz (30KB) - ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ java_apps/       - Javaåº”ç”¨
â”‚   â”‚   â””â”€â”€ java_app_core.tar.gz (22MB) - åº”ç”¨æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/         - é‡è¦è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ checkpy.sh         - æœåŠ¡ç›‘æ§è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ ip.sh              - IPè®°å½•è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ start.sh           - å¯åŠ¨è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ restart.sh         - é‡å¯è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ recover.sh         - æ¢å¤è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ docker-compose.yml - Dockeré…ç½®
â”‚   â”‚   â””â”€â”€ auto-del-7-days-ago-log.sh - æ—¥å¿—æ¸…ç†
â”‚   â”œâ”€â”€ backup_summary.txt     - å¤‡ä»½æ‘˜è¦
â”‚   â””â”€â”€ system_info.txt        - ç³»ç»Ÿä¿¡æ¯
â”œâ”€â”€ backup_server_ali_lanyu.sh   - å®Œæ•´å¤‡ä»½è„šæœ¬
â””â”€â”€ backup_server_quick.sh       - å¿«é€Ÿå¤‡ä»½è„šæœ¬
```

## ğŸ¯ å¤‡ä»½å†…å®¹è¯¦æƒ…

### 1. MySQLæ•°æ®åº“ âœ…
- **å®Œæ•´æ•°æ®åº“å¯¼å‡º**: åŒ…å«æ‰€æœ‰æ•°æ®åº“å’Œè¡¨ç»“æ„
- **æ•°æ®åº“**: ardb, information_schema, mysql, performance_schema, sys
- **ç”¨æˆ·è´¦æˆ·**: root, ardb ç­‰ç”¨æˆ·æƒé™ä¿¡æ¯
- **æ–‡ä»¶å¤§å°**: 1.2MB

### 2. ç³»ç»Ÿé…ç½® âœ…
- **ç”¨æˆ·ç®¡ç†**: /etc/passwd, /etc/group, /etc/shadow
- **ç½‘ç»œé…ç½®**: /etc/hosts
- **MySQLé…ç½®**: /etc/my.cnf
- **SSHé…ç½®**: /etc/ssh/ å®Œæ•´é…ç½®
- **å®šæ—¶ä»»åŠ¡**: crontabé…ç½®
- **æ–‡ä»¶å¤§å°**: 30KB

### 3. NginxæœåŠ¡ âœ…
- **ä¸»é…ç½®**: nginx.conf (3ä¸ªè™šæ‹Ÿä¸»æœº)
  - ç«¯å£443: HTTPS (app.lanyuxr.com)
  - ç«¯å£7891: HTTPç½‘ç«™
  - ç«¯å£8011: æ–‡ä»¶æœåŠ¡
- **SSLè¯ä¹¦**: app.lanyuxr.com.pem, app.lanyuxr.com.key
- **æ‰€æœ‰é…ç½®æ–‡ä»¶**: mime.types, fastcgiç­‰
- **æ–‡ä»¶å¤§å°**: 9.7KB

### 4. Javaåº”ç”¨ âœ…
- **ä¸»åº”ç”¨**: vr-platform.jar (106MB)
- **å¤‡ä»½åº”ç”¨**: bak1vr-platform.jar, bakvr-platform.jar
- **å¯åŠ¨è„šæœ¬**: start.sh
- **å‹ç¼©åå¤§å°**: 22MB

### 5. è¿ç»´è„šæœ¬ âœ…
- **æœåŠ¡ç›‘æ§**: checkpy.sh (æ¯åˆ†é’Ÿæ£€æŸ¥58080ç«¯å£)
- **IPè®°å½•**: ip.sh (è®°å½•æœåŠ¡å™¨IPåˆ°ehcache)
- **æ—¥å¿—æ¸…ç†**: auto-del-7-days-ago-log.sh (æ¸…ç†7å¤©å‰æ—¥å¿—)
- **æœåŠ¡æ§åˆ¶**: start.sh, restart.sh, recover.sh
- **Dockeré…ç½®**: docker-compose.yml

## ğŸ”§ æœåŠ¡æ¶æ„

### ç«¯å£é…ç½®
- **443**: HTTPSç½‘ç«™ (app.lanyuxr.com) + APIä»£ç† â†’ 8081
- **7891**: HTTPç½‘ç«™ + APIä»£ç† â†’ 8081
- **8011**: æ–‡ä»¶æœåŠ¡å™¨ (/usr/local/www/yaoculture/file/)
- **8081**: Javaåç«¯åº”ç”¨ (vr-platform.jar)
- **3306**: MySQLæ•°æ®åº“
- **58080**: PythonæœåŠ¡ (ç›‘æ§æ£€æŸ¥)

### å…³é”®è¿›ç¨‹
```bash
# Javaåº”ç”¨
/home/jdk/jdk-11.0.22/bin/java -jar vr-platform.jar -Xmx1500M -Xms1024M --spring.profiles.active=prod --server.port=8081

# MySQLæ•°æ®åº“
/www/server/mysql/bin/mysqld --datadir=/www/server/data --port=3306

# Nginx WebæœåŠ¡å™¨
nginx: master process nginx
```

### å®šæ—¶ä»»åŠ¡
```bash
* * * * * /bin/sh /data/checkpy.sh      # æ¯åˆ†é’Ÿæ£€æŸ¥PythonæœåŠ¡
* * * * * /bin/sh /data/ip.sh           # æ¯åˆ†é’Ÿè®°å½•IP
10 0 * * * /data/auto-del-7-days-ago-log.sh  # æ¯å¤©æ¸…ç†æ—¥å¿—
```

## ğŸš€ è¿ç§»æŒ‡å—

### 1. ç¯å¢ƒå‡†å¤‡
æ–°æœåŠ¡å™¨éœ€è¦å®‰è£…ï¼š
- CentOS 7
- Java 11 (OpenJDK 11.0.22)
- MySQL 8.0.24
- Nginx (ç¼–è¯‘ç‰ˆæœ¬)
- Docker (å¯é€‰)

### 2. æ¢å¤æ­¥éª¤
1. **è§£å‹å¤‡ä»½**: `tar -xzf backup_ali_lanyu_complete_20250807.tar.gz`
2. **æ¢å¤ç³»ç»Ÿé…ç½®**: è§£å‹ system_configs.tar.gz
3. **æ¢å¤æ•°æ®åº“**: `mysql -u root -p < mysql/all_databases.sql`
4. **æ¢å¤Nginx**: è§£å‹ nginx_configs.tar.gz åˆ° /usr/local/nginx/
5. **éƒ¨ç½²Javaåº”ç”¨**: è§£å‹ java_app_core.tar.gz åˆ° /home/back/
6. **æ¢å¤è„šæœ¬**: å¤åˆ¶æ‰€æœ‰è„šæœ¬åˆ° /data/ ç›®å½•
7. **è®¾ç½®å®šæ—¶ä»»åŠ¡**: å¯¼å…¥ crontab é…ç½®
8. **å¯åŠ¨æœåŠ¡**: MySQL â†’ Nginx â†’ Javaåº”ç”¨

### 3. éªŒè¯æ£€æŸ¥
- [ ] æ£€æŸ¥ç«¯å£ç›‘å¬ï¼š443, 7891, 8011, 8081, 3306
- [ ] éªŒè¯ç½‘ç«™è®¿é—®ï¼šhttps://app.lanyuxr.com
- [ ] æµ‹è¯•APIæ¥å£ï¼š/api/ è·¯ç”±æ˜¯å¦æ­£å¸¸
- [ ] ç¡®è®¤æ•°æ®åº“è¿æ¥å’Œæ•°æ®å®Œæ•´æ€§
- [ ] æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“å¯†ç **: rootå¯†ç ä¸º `4305865740bf490f`
2. **SSLè¯ä¹¦**: å·²åŒ…å«app.lanyuxr.comçš„æœ‰æ•ˆè¯ä¹¦
3. **æ–‡ä»¶æƒé™**: æ³¨æ„æ¢å¤åè®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
4. **ç½‘ç»œé…ç½®**: æ–°æœåŠ¡å™¨IPåœ°å€éœ€è¦æ›´æ–°DNSè§£æ
5. **é˜²ç«å¢™**: ç¡®ä¿å¼€æ”¾å¿…è¦ç«¯å£
6. **å¤‡ä»½éªŒè¯**: å»ºè®®åœ¨æµ‹è¯•ç¯å¢ƒå…ˆéªŒè¯å¤‡ä»½å®Œæ•´æ€§

## ğŸ“ å¤‡ä»½ä¿¡æ¯
- **å¤‡ä»½è„šæœ¬**: å¯é‡å¤è¿è¡Œè¿›è¡Œå¢é‡å¤‡ä»½
- **å¤‡ä»½ç±»å‹**: å®Œæ•´é…ç½® + æ•°æ®åº“ + æ ¸å¿ƒåº”ç”¨
- **é—æ¼å†…å®¹**: å¤§å‹ç½‘ç«™æ–‡ä»¶ã€JDKå®‰è£…åŒ…ã€å†å²æ—¥å¿—
- **å¤‡ä»½è´¨é‡**: âœ… ç”Ÿäº§å°±ç»ª

---
*å¤‡ä»½ç”Ÿæˆæ—¶é—´: 2025-08-07 14:52:54 CST*  
*å¤‡ä»½å·¥å…·: è‡ªå®šä¹‰Shellè„šæœ¬*  
*æœåŠ¡å™¨: ali_lanyu (47.116.172.28)*